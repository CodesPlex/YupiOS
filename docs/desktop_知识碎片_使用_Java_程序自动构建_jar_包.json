{"data": "# \u4f7f\u7528 Java \u7a0b\u5e8f\u81ea\u52a8\u6784\u5efa jar \u5305\n\n> \u4f5c\u8005\uff1a[\u7a0b\u5e8f\u5458\u9c7c\u76ae](https://space.bilibili.com/12890453/)\uff0c[\u7f16\u7a0b\u5bfc\u822a\u661f\u7403](https://yuyuanweb.feishu.cn/wiki/VC1qwmX9diCBK3kidyec74vFnde) \u7f16\u53f7 1\n\n\n\n\u4f20\u7edf\u6784\u5efa jar \u5305\u7684\u65b9\u6cd5\u662f\u901a\u8fc7\u4eba\u5de5\u624b\u52a8\u6267\u884c Maven \u547d\u4ee4\u6765\u5b8c\u6210\u3002\n\n\u4f46\u5982\u679c\u6211\u4eec\u60f3\u8981\u5236\u4f5c\u81ea\u52a8\u5316\u6784\u5efa\u548c\u90e8\u7f72\u9879\u76ee\u7684\u5de5\u5177\uff0c\u5c31\u9700\u8981\u8ba9\u7a0b\u5e8f\u5e2e\u6211\u4eec\u81ea\u52a8\u6784\u5efa jar \u5305\u3002\n\n\u8fd9\u91cc\u4ee5 Java \u8bed\u8a00\u4e3a\u4f8b\uff0c\u5206\u4eab\u4e00\u4e0b\u6559\u7a0b\u3002\n\n\n\n### \u5b9e\u73b0\u601d\u8def\n\n\u7a0b\u5e8f\u7684\u672c\u8d28\u5c31\u662f\u4ee3\u66ff\u4eba\u5de5\u8fdb\u884c\u64cd\u4f5c\uff0c\u6240\u4ee5\u5982\u679c\u8981\u5b9e\u73b0\u7a0b\u5e8f\u81ea\u52a8\u6784\u5efa jar \u5305\uff0c\u53ea\u9700\u8981\u8ba9\u7a0b\u5e8f\u6765\u66ff\u6211\u4eec\u6267\u884c Maven \u6253\u5305\u547d\u4ee4\u5373\u53ef\u3002\n\n\n\n### \u5f00\u53d1\u5b9e\u73b0\n\n1\uff09\u9996\u5148\u9700\u8981\u5728\u672c\u5730\uff08\u6216\u670d\u52a1\u5668\uff09\u5b89\u88c5 Maven \u5e76\u914d\u7f6e\u73af\u5883\u53d8\u91cf\uff0c\u53c2\u8003\u6559\u7a0b\uff1ahttps://blog.csdn.net/qq_45344586/article/details/130935169\n\n\n\n\u5b89\u88c5\u5b8c\u6210\u540e\uff0c\u6253\u5f00\u7ec8\u7aef\uff0c\u6267\u884c `mvn -v` \u547d\u4ee4\u68c0\u6d4b\u662f\u5426\u5b89\u88c5\u6210\u529f\uff0c\u9c7c\u76ae\u672c\u5730\u7684\u73af\u5883\u662f Maven 3.9.5\uff1a\n\n![](https://pic.yupi.icu/1/1701156777614-c96c137e-7465-4795-adfb-258bbaa22b21.png)\n\n\n\n2\uff09\u65b0\u5efa `JarGenerator.java` \u7c7b\uff0c\u7f16\u5199 jar \u5305\u6784\u5efa\u903b\u8f91\u3002\n\n\u7a0b\u5e8f\u5b9e\u73b0\u7684\u5173\u952e\u662f\uff1a\u4f7f\u7528 Java \u5185\u7f6e\u7684 Process \u7c7b\u6267\u884c Maven \u6253\u5305\u547d\u4ee4\uff0c\u5e76\u83b7\u53d6\u5230\u547d\u4ee4\u7684\u8f93\u51fa\u4fe1\u606f\u3002**\u9700\u8981\u6ce8\u610f\uff0c\u4e0d\u540c\u7684\u64cd\u4f5c\u7cfb\u7edf\uff0c\u6267\u884c\u7684\u547d\u4ee4\u4ee3\u7801\u4e0d\u540c\u3002**\n\n\u5b8c\u6574\u4ee3\u7801\u5982\u4e0b\uff1a\n\n```java\npackage com.yupi.maker.generator;\n\nimport java.io.*;\n\npublic class JarGenerator {\n\n    public static void doGenerate(String projectDir) throws IOException, InterruptedException {\n        // \u6e05\u7406\u4e4b\u524d\u7684\u6784\u5efa\u5e76\u6253\u5305\n        // \u6ce8\u610f\u4e0d\u540c\u64cd\u4f5c\u7cfb\u7edf\uff0c\u6267\u884c\u7684\u547d\u4ee4\u4e0d\u540c\n        String winMavenCommand = \"mvn.cmd clean package -DskipTests=true\";\n        String otherMavenCommand = \"mvn clean package -DskipTests=true\";\n        String mavenCommand = winMavenCommand;\n        \n        // \u8fd9\u91cc\u4e00\u5b9a\u8981\u62c6\u5206\uff01\n        ProcessBuilder processBuilder = new ProcessBuilder(mavenCommand.split(\" \"));\n        processBuilder.directory(new File(projectDir));\n\n        Process process = processBuilder.start();\n\n        // \u8bfb\u53d6\u547d\u4ee4\u7684\u8f93\u51fa\n        InputStream inputStream = process.getInputStream();\n        BufferedReader reader = new BufferedReader(new InputStreamReader(inputStream));\n        String line;\n        while ((line = reader.readLine()) != null) {\n            System.out.println(line);\n        }\n\n        // \u7b49\u5f85\u547d\u4ee4\u6267\u884c\u5b8c\u6210\n        int exitCode = process.waitFor();\n        System.out.println(\"\u547d\u4ee4\u6267\u884c\u7ed3\u675f\uff0c\u9000\u51fa\u7801\uff1a\" + exitCode);\n    }\n\n    public static void main(String[] args) throws IOException, InterruptedException {\n        doGenerate(\"C:\\\\code\\\\yuzi-generator\\\\yuzi-generator-maker\\\\generated\\\\acm-template-pro-generator\");\n    }\n}\n```\n\n\n\n\u9700\u8981\u6ce8\u610f\uff0c\u8981\u628a\u4e0a\u8ff0\u4ee3\u7801 main \u65b9\u6cd5\u4e2d\u7684\u751f\u6210\u8def\u5f84\u6539\u4e3a\u81ea\u5df1\u672c\u5730\u7684\u9879\u76ee\u8def\u5f84\u3002\n\n\n\n3\uff09\u60f3\u4f7f\u7528 Maven \u6253\u5305\u9879\u76ee\uff0c\u9879\u76ee\u7684\u6839\u76ee\u5f55\u4e0b\u5fc5\u987b\u8981\u6709 `pom.xml` \u9879\u76ee\u7ba1\u7406\u6587\u4ef6\u3002\u800c\u4e14\u5728 `pom.xml` \u4e2d\uff0c\u9700\u8981\u4f7f\u7528 `maven-assembly-plugin` \u63d2\u4ef6\uff0c\u5b9e\u73b0\u5c06\u4f9d\u8d56\u4e00\u8d77\u6253\u5230 jar \u5305\u4e2d\u3002\n\n\u5b8c\u6574\u4ee3\u7801\u5982\u4e0b\uff0c\u6ce8\u610f\u8981\u5c06 `mainClass` \u6807\u7b7e\u7684\u5185\u5bb9\u6539\u4e3a\u81ea\u5df1\u9879\u76ee\u4e2d\u53ef\u8fd0\u884c\u7684\u4e3b\u7c7b\u8def\u5f84\uff1a\n\n```xml\n<build>\n    <plugins>\n        <plugin>\n            <groupId>org.apache.maven.plugins</groupId>\n            <artifactId>maven-assembly-plugin</artifactId>\n            <version>3.3.0</version>\n            <configuration>\n                <descriptorRefs>\n                    <descriptorRef>jar-with-dependencies</descriptorRef>\n                </descriptorRefs>\n                <archive>\n                    <manifest>\n                        <mainClass>${basePackage}.Main</mainClass> <!-- \u66ff\u6362\u4e3a\u4f60\u7684\u4e3b\u7c7b\u7684\u5b8c\u6574\u7c7b\u540d -->\n                    </manifest>\n                </archive>\n            </configuration>\n            <executions>\n                <execution>\n                    <phase>package</phase>\n                    <goals>\n                        <goal>single</goal>\n                    </goals>\n                </execution>\n            </executions>\n        </plugin>\n    </plugins>\n</build>\n```\n\n\n\n4\uff09\u4e4b\u540e\u901a\u8fc7\u4e00\u884c\u4ee3\u7801\u5c31\u53ef\u4ee5\u6784\u5efa jar \u5305\u4e86\uff1a\n\n```java\npublic class MainGenerator {\n\n    public static void main(String[] args) throws IOException, InterruptedException {\n    \tString outputPath = \"\u9879\u76ee\u4ee3\u7801\u6839\u8def\u5f84\";\n        // \u6784\u5efa jar \u5305\n        JarGenerator.doGenerate(outputPath);\n    }\n}\n```\n\n\n\n### \u8c03\u7528\u6d4b\u8bd5\n\n\u6d4b\u8bd5 jar \u5305\u6784\u5efa\uff0c\u9996\u6b21\u6784\u5efa\u9700\u8981\u62c9\u53d6\u4f9d\u8d56\u4fe1\u606f\uff0c\u8981\u7b49\u4e00\u6bb5\u65f6\u95f4\u3002\n\n\u6700\u540e\u770b\u5230\u4e0b\u56fe\u7684\u8f93\u51fa\u4fe1\u606f\uff0c\u8868\u793a\u6253\u5305\u6210\u529f\uff1a\n\n![](https://pic.yupi.icu/1/1701159049699-4039d707-089c-447d-b46c-a001f7ca37a3.png)\n\n\n\n\u5728\u751f\u6210\u7684\u76ee\u5f55\u4e2d\u770b\u5230\u4e86 pom.xml \u548c jar \u5305\u6587\u4ef6\uff1a\n\n![](https://pic.yupi.icu/1/1701159417464-4d8e051c-b4f6-4df3-b70e-871a2271c110.png)\n\n\n\n### \u5b9e\u8df5\n\n\u7f16\u7a0b\u5bfc\u822a\u661f\u7403\u7684\u5b9a\u5236\u5316\u4ee3\u7801\u751f\u6210\u9879\u76ee\u4e2d\uff0c\u4f7f\u7528\u4e86\u4e0a\u8ff0\u65b9\u5f0f\u5b9e\u73b0 jar \u5305\u7684\u81ea\u52a8\u6784\u5efa\u3002\n\n\ud83d\udc49\ud83c\udffb \u7f16\u7a0b\u5bfc\u822a\u539f\u521b\u9879\u76ee\u6559\u7a0b\u7cfb\u5217\uff1ahttps://yuyuanweb.feishu.cn/wiki/SePYwTc9tipQiCktw7Uc7kujnCd"}