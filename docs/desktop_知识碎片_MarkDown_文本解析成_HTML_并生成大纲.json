{"data": "# MarkDown \u6587\u672c\u89e3\u6790\u6210 HTML \u5e76\u751f\u6210\u5927\u7eb2\n\n> \u4f5c\u8005\uff1a[\u8fc7....](https://wx.zsxq.com/dweb2/index/footprint/212511211885411)\uff0c[\u7f16\u7a0b\u5bfc\u822a\u661f\u7403](https://wx.zsxq.com/dweb2/index/group/51122858222824) \u7f16\u53f7 30885\n\nmarkdown\u8f6c\u6362\u6210html\u53c2\u8003\uff1ahttps://blog.csdn.net/weixin_45894305/article/details/106362783?spm=1001.2014.3001.5506\n\n### \u6e32\u67d3\u540e\u6837\u5f0f\u8ddf\u9884\u671f\u4e0d\u7b26\n\n\u6dfb\u52a0css\u5373\u53ef\uff0c\u4e00\u822c\u76f4\u63a5\u5728\u7236\u6807\u7b7e\u4e0a\u8bbe\u5b9a\u4e00\u4e2a\u7c7b\u540d\u7136\u540e\u7ed9\u5b50\u6807\u7b7e\u52a0\u6837\u5f0f\uff1a \u53ef\u4ee5\u5728github\u4e0a\u627e\u4e00\u4e2a\u7528\uff1ahttps://github.com/sindresorhus/github-markdown-css\n\n### \u8f6c\u6362\u6210html\u65e0\u6cd5\u901a\u8fc7js\u64cd\u4f5c\n\n\u8fd9\u662f\u56e0\u4e3a\u8f6c\u6362\u540edom\u52a0\u8f7d\u9700\u8981\u4e00\u5b9a\u7684\u65f6\u95f4\uff0c\u5728\u8fd9\u4e2a\u65f6\u95f4\u5185\u64cd\u4f5c\u4f1a\u51fa\u73b0 null \u95ee\u9898\uff0c\u89e3\u51b3\uff1a\n\n```go\nsetTimeout(() => {\n      //\u8981\u5904\u7406\u8f6c\u6362html\u540e\u7684\u903b\u8f91\n  },1)\n```\n\n\u4e00\u822c\u53c2\u65701\u6beb\u79d2\u5373\u53ef\uff0c\u6700\u597d\u8bbe\u5927\u4e00\u70b9\n\n### \u751f\u6210\u5927\u7eb2\n\n#### \u62ff\u5230\u6240\u6709\u5b50\u6807\u7b7e\n\n\u5f53dom\u6e32\u67d3\u4e0a\u53bb\u540e\uff0c\u6211\u4eec\u53bb\u83b7\u53d6\u5230\u7528\u4e8e\u6e32\u67d3html\u6587\u672c\u7684\u6807\u7b7e\u7684\u6240\u6709\u5b50\u6807\u7b7e\n\n```go\ndocument.querySelector(\".markdown-body\").children\n```\n\n#### \u901a\u8fc7\u6b63\u5219\u8868\u8fbe\u5f0f\u63d0\u53d6\u51fah1-h10\u4e4b\u95f4\u7684\u6807\u7b7e\n\n```go\nconst regex =  /h(10|[1-9])/g;\n      for (let i = 0; i < document.querySelector(\".markdown-body\").children.length; i++){\n        if (htmlContent[i].localName.match(regex)) {\n            \n        }\n}\n```\n\n#### \u5904\u7406\u6bcf\u4e2a\u6807\u9898\n\n\u5927\u7eb2\u4e00\u822c\u90fd\u6709\u7236\u5b50\u5173\u7cfb\uff0c\u6211\u4eec\u9700\u8981\u53bb\u5bf9\u6bcf\u4e2a\u6807\u9898\u8fdb\u884c\u7236\u5b50\u5173\u7cfb\u7684\u5904\u7406\uff0c\u6bd4\u5982\u6807\u9898 3 \u5728\u6807\u9898 1 \u7684\u540e\u9762\uff0c\u90a3\u4ed6\u5c31\u662f\u6807\u9898 1 \u7684\u5b50\u6807\u9898\n\n```go\nconst  treeData = ref([]);\n//\u662f\u5426\u627e\u5230\u5b50\u76ee\u5f55\nlet isFind = false;\n//\u89e3\u6790\u5b50\u76ee\u5f55\nconst setSubDirectory = (directory, level, label) => {\n  //\u8868\u793a\u5f53\u524d\u7684\u76ee\u5f55\u5c42\u7ea7\n  const curr = directory\n  //\u8868\u793a\u9012\u5f52\u7684\u76ee\u5f55\u5c42\u7ea7\n  const children = directory.children\n  if (children.length > 0) {\n    //\u9012\u5f52\u5b50\u76ee\u5f55\uff0c\u4ece\u6700\u540e\u4e00\u4e2a\u5b69\u5b50\u5f00\u59cb\n    setSubDirectory(directory.children[children.length-1],level,label)\n  }\n  //\u5b50\u76ee\u5f55\u5df2\u7ecf\u5f52\u4f4d\n  if (isFind === true) return;\n  //\u5f53\u524d\u5c42\u7ea7\u5c0f\u4e8e\u7b49\u4e8e\u76ee\u5f55\u5c42\u7ea7\uff0c\u8868\u793a\u627e\u5230\u4e86\u76ee\u5f55\n  if (curr.level < level) {\n    isFind = true\n    curr.children.push({ level, label,children: []})\n  }\n}\n\n//\u89e3\u6790html\uff0c\u751f\u6210\u76ee\u5f55\u6811\nconst setTreeDataByHtml = (htmlContent) => {\n  const regex =  /h(10|[1-9])/g;\n      for (let i = 0; i < htmlContent.length; i++){\n        if (htmlContent[i].localName.match(regex)) {\n          const level = parseInt(htmlContent[i].localName.replace(\"h\", \"\"))\n          const label = htmlContent[i].innerText\n          //\u4e0d\u9700\u8981\u627e\u5b50\u76ee\u5f55\n          if (treeData.value.length === 0 || treeData.value[treeData.value.length - 1].level >= level) {\n              treeData.value.push({ label, level,children: []})\n          } else {\n            isFind = false\n            setSubDirectory(treeData.value[treeData.value.length - 1],level,label)\n          } \n        }\n}\n}\n```\n\n> \u7ec6\u8282\uff1a\u6211\u4eec\u5c06\u6807\u9898\u5206\u4e3a\u4e24\u7c7b\uff0c\u4e00\u79cd\u662f\u76f4\u63a5\u53ef\u4ee5\u7528\u4f5c\u7236\u6807\u9898\uff0c\u4e00\u79cd\u5219\u662f\u9700\u8981\u6dfb\u52a0\u5728\u7236\u6807\u9898\u4e2d\u7684\u5b50\u6807\u9898 \u5982\u679c\u5f53\u524d\u6807\u9898\u7684\u5c42\u7ea7\u5c0f\u4e8e\u7b49\u4e8e\u6570\u636e\u4e2d\u6700\u540e\u4e00\u4e2a\u7236\u6807\u9898\u7684\u5c42\u7ea7\uff0c\u90a3\u4e48\u4ed6\u5c31\u662f\u7236\u6807\u9898\uff0c\u76f4\u63a5\u6dfb\u52a0\u5230\u6570\u7ec4\u4e2d\u5373\u53ef \u5b50\u6807\u9898\u901a\u8fc7\u9012\u5f52\u7684\u65b9\u5f0f\uff0c\u5148\u627e\u5230\u6700\u5e95\u5c42\u7684\u6807\u9898\uff0c\u4f9d\u6b21\u5f80\u4e0a\u5bfb\u627e\uff0c\u76f4\u5230\u627e\u5230\u5408\u9002\u7684\u4f4d\u7f6e\u5373\u53ef \u5408\u9002\u7684\u4f4d\u7f6e\uff1a\u5b50\u6807\u9898\u7684\u5c42\u7ea7\u5927\u4e8e\u7236\u6807\u9898\u7684\u5c42\u7ea7\uff0c\u8fd9\u91cc\u6211\u4eec\u7528level\u6765\u8868\u793a\n\n#### \u89e3\u6790\u751f\u6210\u5927\u7eb2\n\n\u901a\u8fc7 element-plus \u4e2d\u7684 tree\u7ec4\u4ef6\u5e93\u6765\u5b9e\u73b0\n\n#### \u6d4b\u8bd5\u7ed3\u679c\n\n![](https://pic.yupi.icu/5563/202401081829355.png)\n\n#### \u5b8c\u6574\u4ee3\u7801\n\n> tips: \u590d\u5236\u8fc7\u53bb\u8bb0\u5f97\u6539\uff0c\u662f\u62ff\u4ee5\u524d\u9879\u76ee\u5199\u7684\n\n\u6587\u7ae0\u8be6\u60c5\u9875\uff0c\u5728\u6b64\u5f15\u7528\u5927\u7eb2\u9875\u9762\uff0c\u4e3a ArticleTree\uff0c\u8c03\u7528 ArticleTree \u91cc\u7684\u51fd\u6570\u751f\u6210\u5927\u7eb2\u7684\u51fd\u6570\u572882\u884c\n\n```go\n<template>\n  <div class=\"container view\">\n    <div class=\"card\">\n      <div class=\"card-body\">\n        <h3>{{ share.title }}</h3>\n        <span class=\"author_descibe\" style=\"margin-left: 0px\">\u4f5c\u8005\uff1a</span>\n        <router-link class=\"ToOpenShare\" :to=\"{ name: 'home' }\">\n          <img :src=\"share.authorPhoto\" alt=\"\" />\n          <span class=\"author\" style=\"font-size: 18px; margin-left: 10px\"\n            >{{ share.author }}\n          </span>\n        </router-link>\n        <span class=\"createtime\">{{ share.createtime }}</span>\n        <span class=\"reading_descibe\">\u9605\u8bfb</span>\n        <span class=\"reading\">{{ share.reading }}</span>\n        <hr />\n\n        <div v-html=\"share.content\" class=\"markdown-body\"></div>\n      </div>\n    </div>\n\n    <hr />\n\n    <CommentView :shareId=\"route.params.shareId\" />\n  </div>\n <ArticleTree ref=\"ArticleTreeRef\"/> \n</template>\n\n<script>\nimport $ from \"jquery\";\nimport { useRoute } from \"vue-router\";\nimport { useStore } from \"vuex\";\nimport { reactive, onMounted,ref } from \"vue\";\nimport CommentView from \"@/views/share/comment/CommentView.vue\";\nimport { marked } from 'marked';\nimport ArticleTree from \"./ArticleTree.vue\";\n\nexport default {\n  components: {\n    CommentView,ArticleTree\n  },\n  setup() {\n    const store = useStore();\n    const route = useRoute();\n    const ArticleTreeRef = ref(null)\n    const share = reactive({\n      title: \"\",\n      createtime: \"\",\n      content: \"\",\n      reading: null,\n      authorPhoto: \"\",\n      author: \"\",\n    });\n    onMounted(() => {\n    const link = document.createElement('link')\n    link.type = 'text/css'\n    link.rel = 'stylesheet'\n    link.href = 'https://cdn.bootcss.com/github-markdown-css/2.10.0/github-markdown.min.css'\n    document.head.appendChild(link)\n});\n\n    \n    //\u6253\u5f00\u67d0\u4e00\u5206\u4eab\u9875\u9762\u5c31\u8c03\u7528\n    const getShare = () => {\n      $.ajax({\n        url: \"https://app5608.acapp.acwing.com.cn/api/get/share/\",\n        type: \"get\",\n        data: {\n          userId: store.state.user.id,\n          shareId: route.params.shareId,\n        },\n        headers: {\n          Authorization: \"Bearer \" + store.state.user.token,\n        },\n\n        success(resp) {\n          // eslint-disable-next-line no-empty\n          if (resp.error_message === \"successfully\") {\n            share.title = resp.share.title;\n            share.createtime = resp.share.createTime;\n            share.content = marked(resp.share.content)\n            setTimeout(() => {\n      ArticleTreeRef.value.setTreeDataByHtml(document.querySelector(\".markdown-body\").children)\n  },1)\n            share.reading = resp.share.reading;\n            share.authorPhoto = resp.authorPhoto;\n            share.author = resp.author;\n          }\n        },\n        error() {},\n      });\n    };\n\n    getShare();\n\n    return {\n      share,\n      route,\n      ArticleTreeRef,\n    };\n  },\n};\n</script>\n\n<style scoped>\n.view {\n  margin-top: 20px;\n}\n\n.container {\n  max-width: 900px;\n}\nhr {\n  color: gray;\n}\nimg {\n  border-radius: 50%;\n  width: 4vh;\n  height: 4vh;\n  margin-left: 10px;\n  line-height: 15px;\n}\n\n.author_descibe,\n.createtime,\n.reading_descibe,\n.reading {\n  font-size: 12px;\n  color: gray;\n  margin-left: 10px;\n}\n\n.ToOpenShare {\n  color: rgb(51, 122, 199);\n  text-decoration: none;\n  line-height: 30px;\n  font-size: 16px;\n}\n\n.ToOpenShare:hover {\n  color: rgb(35, 82, 124);\n  text-decoration: underline;\n}\n</style>\n```\n\nArticleTree\n\n```go\n<!-- \u5c06\u6587\u7ae0\u76ee\u5f55\u4ee5\u6811\u7684\u5f62\u5f0f\u5c55\u793a -->\n<template>\n  <el-tree :data=\"treeData\" :expand-on-click-node=\"false\" class=\"tree\"></el-tree>\n</template>\n\n<script setup>\nimport { ref,defineExpose } from \"vue\";\nconst  treeData = ref([]);\n//\u662f\u5426\u627e\u5230\u5b50\u76ee\u5f55\nlet isFind = false;\n//\u89e3\u6790\u5b50\u76ee\u5f55\nconst setSubDirectory = (directory, level, label) => {\n  //\u8868\u793a\u5f53\u524d\u7684\u76ee\u5f55\u5c42\u7ea7\n  const curr = directory\n  //\u8868\u793a\u9012\u5f52\u7684\u76ee\u5f55\u5c42\u7ea7\n  const children = directory.children\n  if (children.length > 0) {\n    //\u9012\u5f52\u5b50\u76ee\u5f55\uff0c\u540c\u5c42\u7ea7\u4e0b\uff0c\u6570\u7ec4\u4e0b\u6807\u5728\u5176\u8303\u56f4\u5373\u53ef\n    setSubDirectory(directory.children[children.length-1],level,label)\n  }\n  //\u5b50\u76ee\u5f55\u5df2\u7ecf\u5f52\u4f4d\n  if (isFind === true) return;\n  //\u5f53\u524d\u5c42\u7ea7\u5c0f\u4e8e\u7b49\u4e8e\u76ee\u5f55\u5c42\u7ea7\uff0c\u8868\u793a\u627e\u5230\u4e86\u76ee\u5f55\n  if (curr.level < level) {\n    isFind = true\n    curr.children.push({ level, label,children: []})\n  }\n}\n\n//\u89e3\u6790html\uff0c\u751f\u6210\u76ee\u5f55\u6811\nconst setTreeDataByHtml = (htmlContent) => {\n  const regex =  /h(10|[1-9])/g;\n      for (let i = 0; i < htmlContent.length; i++){\n        if (htmlContent[i].localName.match(regex)) {\n          const level = parseInt(htmlContent[i].localName.replace(\"h\", \"\"))\n          const label = htmlContent[i].innerText\n          //\u4e0d\u9700\u8981\u627e\u5b50\u76ee\u5f55\n          if (treeData.value.length === 0 || treeData.value[treeData.value.length - 1].level >= level) {\n              treeData.value.push({ label, level,children: []})\n          } else {\n            isFind = false\n            setSubDirectory(treeData.value[treeData.value.length - 1],level,label)\n          } \n        }\n}\n}\ndefineExpose({\n  setTreeDataByHtml\n})\n</script>\n\n\n<style scoped>\n.tree{\n  width: 20%;\n  position: fixed;\n  top: 80px;  /* \u4ece\u9875\u9762\u9876\u90e8\u7684\u8ddd\u79bb */\n  right: 50px; /* \u4ece\u9875\u9762\u5de6\u4fa7\u7684\u8ddd\u79bb */\n}\n</style>\n```\n\n### \u70b9\u51fb\u76ee\u5f55\u5bfc\u822a\u5230\u5bf9\u5e94\u6807\u9898\u4f4d\u7f6e\n\n\u53ea\u8981\u83b7\u53d6\u5230dom\u5b9e\u4f8b\uff0c\u901a\u8fc7scrollIntoView\u51fd\u6570\u5373\u53ef\u5b8c\u6210 \u793a\u4f8b\uff1a\n\n```go\nelement.scrollIntoView({\n          behavior: \"instant\",\n          block: \"center\",\n        });\n```\n\n### \u5f53\u6eda\u52a8\u6761\u6eda\u52a8\u5230\u6807\u9898\u4f4d\u7f6e\uff0c\u8bbe\u7f6e\u76ee\u5f55\u91cc\u6807\u9898\u9ad8\u4eae\n\n\u901a\u8fc7IntersectionObserver\u5b9e\u4f8b\u6765\u505a\uff0c\u5f53\u76d1\u542c\u7684dom\u51fa\u73b0\u5728\u89c6\u56fe\u533a\u57df\u4e2d\uff0c\u4f1a\u89e6\u53d1\u56de\u8c03\u51fd\u6570\uff0c\u4ece\u800c\u6765\u8bbe\u7f6e\u9ad8\u4eae \u793a\u4f8b\uff1a\n\n```go\n// \u521b\u5efa Intersection Observer \u5b9e\u4f8b\nconst observer = new IntersectionObserver((entries) => {\n  entries.forEach((entry) => {\n    if (entry.isIntersecting) {\n      // \u76ee\u6807\u5143\u7d20\u8fdb\u5165\u53ef\u89c6\u533a\u57df\n      treeRef.value.setCurrentKey(entry.target.id)\n    }\n  });\n}, { threshold: 0 });\n//\u5c06\u8981\u76d1\u542c\u7684\u76ee\u6807\u5143\u7d20\u52a0\u5165Observer\u4e2d\nobserver.observe(htmlContent[i])\n```\n\n> htmlContent[i] \u4ee3\u8868\u4f60\u8981\u76d1\u542c\u76ee\u6807\u5143\u7d20\u7684dom"}