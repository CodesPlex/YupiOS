{"data": "# Nacos \u914d\u7f6e\u4e2d\u5fc3\u642d\u5efa\n\n> \u4f5c\u8005\uff1a[\u5fc3\u6bd4\u5929\u9ad8\uff0c](https://blog.csdn.net/weixin_52258854)\uff0c[\u7f16\u7a0b\u5bfc\u822a\u661f\u7403](https://wx.zsxq.com/dweb2/index/group/51122858222824) \u7f16\u53f7 452\n\n> \u5b98\u65b9\u6587\u6863\uff1a[https://nacos.io/zh-cn/docs/v2/quickstart/quick-start.html](https://nacos.io/zh-cn/docs/v2/quickstart/quick-start.html)\n\n### \u7248\u672c\u9009\u62e9\n![](https://pic.yupi.icu/5563/202311062040531.png)\uff082023.07.06)\n### \u642d\u5efa\n\n1. \u4e0b\u8f7d\u5e76\u89e3\u538b\uff0c\u4e0b\u8f7d\u5730\u5740\uff1a[https://github.com/alibaba/nacos/releases?page=2](https://github.com/alibaba/nacos/releases?page=2)\n2. \u5355\u673a\u542f\u52a8\u547d\u4ee4\uff1a\n```bash\nsh startup.sh -m standalone\n```\n\n3. \u67e5\u770b\u65e5\u5fd7\u786e\u5b9a\u662f\u5426\u542f\u52a8\u6210\u529f\n```bash\ntail -n 5 /Users/wangzhihao/dev_tools/nacos/logs/start.out\n```\n![](https://pic.yupi.icu/5563/202311062041705.png)\n### SpringBoot \u4e2d\u4f7f\u7528\n#### \u4f9d\u8d56\n```xml\n<dependency>\n  <groupId>org.springframework.cloud</groupId>\n  <artifactId>spring-cloud-starter-bootstrap</artifactId>\n  <version>3.1.3</version>\n</dependency>\n<dependency>\n  <groupId>com.alibaba.boot</groupId>\n  <artifactId>nacos-config-spring-boot-starter</artifactId>\n  <version>0.2.12</version>\n</dependency>\n```\n#### \u914d\u7f6e\n```yaml\nnacos:\n  config:\n    server-addr: 127.0.0.1:8848\n    auto-refresh: true\n    group: DEFAULT_GROUP\n    username: nacos\n    password: nacos\n    namespace: projectName\n```\ntip\uff1anacos.config.bootstrap.enable \u4e3a true \u65f6\uff0c\u624d\u80fd\u4ece nacos \u8bfb\u53d6\u542f\u52a8\u914d\u7f6e \u5982 \u7aef\u53e3\u53f7 \u7b49\n#### \u4f7f\u7528\n\n1. \u901a\u8fc7 @NacosConfigListener(dataId = \"\") \u76d1\u542c\u6307\u5b9a\u914d\u7f6e\u6587\u4ef6\u7684\u53d8\u5316\n```java\n@NacosConfigListener(dataId = \"nacos-test-config\")\npublic void onChange(String config) {\ntry {\n    vipConfigList = JSONUtil.toList(config, VipConfig.class);\n} catch (Exception e) {\n    throw new RuntimeException(e);\n}\n}\n```\nnacos-test-config\uff1a\n```json\n[\n  {\n    \"role\": \"ban\",\n    \"addLeftNum\": 0,\n    \"maxLeftNum\": 10,\n    \"maxChatUserNum\": 12,\n    \"messageRetainDay\": 0,\n    \"downloadDrawPictureCost\": 100\n  },\n  {\n    \"role\": \"user\",\n    \"addLeftNum\": 50,\n    \"maxLeftNum\": 100,\n    \"maxChatUserNum\": 2,\n    \"messageRetainDay\": 7,\n    \"downloadDrawPictureCost\": 5\n  },\n  {\n    \"role\": \"vip\",\n    \"addLeftNum\": 100,\n    \"maxLeftNum\": 1000,\n    \"maxChatUserNum\": 10,\n    \"messageRetainDay\": 30,\n    \"downloadDrawPictureCost\": 0,\n    \"drawMode\": \"fast\"\n  },\n  {\n    \"role\": \"svip\",\n    \"addLeftNum\": 200,\n    \"maxLeftNum\": 3000,\n    \"maxChatUserNum\": 20,\n    \"messageRetainDay\": 90,\n    \"downloadDrawPictureCost\": 0,\n    \"modelMaxTokens\": 4096,\n    \"drawMode\": \"fast\"\n  },\n  {\n    \"role\": \"admin\",\n    \"addLeftNum\": 200,\n    \"maxLeftNum\": 3000,\n    \"maxChatUserNum\": 20,\n    \"messageRetainDay\": 90,\n    \"downloadDrawPictureCost\": 0,\n    \"drawMode\": \"fast\"\n  }\n]\n\n```\n\n2. @NacosInjected \uff0c\u53ef\u6ce8\u5165 ConfigService \uff08\u5728\u7a0b\u5e8f\u4e2d\u63a7\u5236\u66f4\u6539\u6216\u62c9\u53d6\u914d\u7f6e\u53ca\u5176\u4ed6\u64cd\u4f5c\uff0c\u7c7b\u4f3c\u4e8e\u914d\u7f6e\u4e2d\u5fc3\u7684\u64cd\u4f5c\u5ba2\u6237\u7aef\uff09 \u6216 NamingService\n```java\n@NacosInjected\nprivate ConfigService configService;\n\n@PostConstruct\npublic void initVipConfig() {\n    try {\n        String content = configService.getConfig(dataId, groupId, 5000);\n        vipConfigList = JSONUtil.toList(content, VipConfig.class);\n    } catch (NacosException e) {\n        e.printStackTrace();\n    }\n}\n```\n#### \u63a5\u5165 MySQL\nNacos \u5185\u7f6e\u4e86 derby \u5d4c\u5165\u5f0f\u6570\u636e\u5e93\uff0c\u6bcf\u542f\u52a8\u4e00\u4e2a Nacos \u5c31\u4f1a\u6709\u4e00\u4e2a\u6570\u636e\u5e93\uff0c\u800c\u6211\u4eec\u5728\u4f7f\u7528 Nacos \u65f6\u5f80\u5f80\u90fd\u662f\u96c6\u7fa4\uff0c\u4f7f\u7528 derby \u6570\u636e\u4e0d\u80fd\u4e92\u901a\u4f1a\u5f88\u9ebb\u70e6\u3002\u6240\u4ee5\u6211\u4eec\u9700\u8981\u4e00\u4e2a\u5916\u90e8\u7684\u7edf\u4e00\u7684\u6570\u636e\u5e93\uff0cNacos \u5728 0.7 \u7248\u672c\u589e\u52a0\u4e86\u652f\u6301 [mysql](https://cloud.tencent.com/product/cdb?from=20065&from_column=20065) \u6570\u636e\u6e90\u7684\u80fd\u529b\u3002\n~~\u5982\u679c Nacos \u5728\u5355\u673a\u73af\u5883\u4e0b\u8fd0\u884c\uff0c\u5219\u6ca1\u6709\u5fc5\u8981\u66ff\u6362\u4e3a MySQL \u3002~~\uff08\u540e\u671f\u6570\u636e\u4e0d\u597d\u8fc1\u79fb\uff09\n\u66ff\u6362\u6587\u6863\uff1a[https://nacos.io/zh-cn/docs/deployment.html](https://nacos.io/zh-cn/docs/deployment.html)\n![](https://pic.yupi.icu/5563/202311062041853.png)\n\n#### \u8ba4\u8bc1\n> \u6587\u6863\uff1a[https://nacos.io/zh-cn/docs/auth.html](https://nacos.io/zh-cn/docs/auth.html)\n> \u6ce8\u610f\n> - Nacos\u662f\u4e00\u4e2a\u5185\u90e8\u5fae\u670d\u52a1\u7ec4\u4ef6\uff0c\u9700\u8981\u5728\u53ef\u4fe1\u7684\u5185\u90e8\u7f51\u7edc\u4e2d\u8fd0\u884c\uff0c\u4e0d\u53ef\u66b4\u9732\u5728\u516c\u7f51\u73af\u5883\uff0c\u9632\u6b62\u5e26\u6765\u5b89\u5168\u98ce\u9669\u3002\n> - Nacos\u63d0\u4f9b\u7b80\u5355\u7684\u9274\u6743\u5b9e\u73b0\uff0c\u4e3a\u9632\u6b62\u4e1a\u52a1\u9519\u7528\u7684\u5f31\u9274\u6743\u4f53\u7cfb\uff0c\u4e0d\u662f\u9632\u6b62\u6076\u610f\u653b\u51fb\u7684\u5f3a\u9274\u6743\u4f53\u7cfb\u3002\n> - \u5982\u679c\u8fd0\u884c\u5728\u4e0d\u53ef\u4fe1\u7684\u7f51\u7edc\u73af\u5883\u6216\u8005\u6709\u5f3a\u9274\u6743\u8bc9\u6c42\uff0c\u8bf7\u53c2\u8003\u5b98\u65b9\u7b80\u5355\u5b9e\u73b0\u505a\u66ff\u6362\u589e\u5f3a\u3002\n\n![](https://pic.yupi.icu/5563/202311062041400.png)\n### SpringCloud \u4e2d\u4f7f\u7528\n#### \u4f9d\u8d56\n```xml\n<dependency>\n  <groupId>com.alibaba.cloud</groupId>\n  <artifactId>spring-cloud-starter-alibaba-nacos-config</artifactId>\n  <version>${cloud.alibaba}</version>\n</dependency>\n<dependency>\n  <groupId>org.springframework.cloud</groupId>\n  <artifactId>spring-cloud-starter-bootstrap</artifactId>\n  <version>3.0.3</version>\n</dependency>\n<dependency>\n  <groupId>org.springframework.boot</groupId>\n  <artifactId>spring-boot-starter-actuator</artifactId>\n</dependency>\n```\n#### \u914d\u7f6e( bootstrap.yml )\n```yaml\nspring:\n  cloud:\n    nacos:\n      config:\n        server-addr: 127.0.0.8848\n        namespace: cloud\n  application:\n    name: cloud-nacos\n```\n"}